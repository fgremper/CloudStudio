package ch.ethz.fgremper.rtca;

import java.io.File;
import java.util.HashMap;

import org.apache.commons.configuration.XMLConfiguration;
import org.apache.commons.io.FileUtils;

/**
 * Utility to read in .sql files to string for big SQL queries. Also caching queries that we already read.
 * @author Fabian Gremper
 */
public class SqlQueryReader {
	private static SqlQueryReader sqlQueryReader;
	private HashMap<String, String> map = new HashMap<String, String>();
	
	/**
	 * Read an SQL query
	 * @param queryName name of the query which maps to the filename without the ".sql" extension
	 * @return content of the file
	 */
	public String getQuery(String queryName) {
		if (map.containsKey(queryName)) {
			return map.get(queryName);
		}
		else {
			try {
				String content = FileUtils.readFileToString(new File(queryName + ".sql"), "UTF-8");
				map.put(queryName, content);
				return content;
			}
			catch (Exception e) {
				e.printStackTrace();
				return null;
			}
		}
	}
	
	/**
	 * Get instance of the SqlQueryReader
	 * @return SqlQueryReader
	 */
	public static SqlQueryReader getInstance() {
		if (sqlQueryReader == null) {
			sqlQueryReader = new SqlQueryReader();
		}
		return sqlQueryReader;
	}

}
